= bootstrap_form_for [@unit, @user], layout: :horizontal, label_col: 'col-md-2', control_col: 'col-md-8' do |f|
  = render partial: 'layouts/flash', locals: {flash: flash, ar_object: @user}

  .form-group
    = f.label :unit, class: 'control-label col-md-3'
    .col-md-6
      .text-xlarge= @unit.name

  = f.text_field :first_name, control_col: 'col-md-3', placeholder: 'first name'
  = f.text_field :last_name, control_col: 'col-md-3', placeholder: 'last name'
  - if current_user.admin? && current_user.adult?
    = f.select :role, options_for_user_roles, control_col: 'col-md-2'
  - else
    .form-group
      = label_tag :role, nil, class: 'control-label col-md-3'
      .col-md-2
        = text_field_tag :role, @user.role, readonly: true, class: 'form-control'
      .col-md-2
        %span.fa-stack{data: {toggle: 'tooltip', placement: 'right'}, title: 'You must have admin rights to change roles'}
          %i.fa.fa-circle.fa-stack-2x.tooltip_circle.fa-sm
          %i.fa.fa-question.fa-stack-1x.fa-inverse

  = f.collection_select :sub_unit_id, @unit.sub_units, :id, :name, include_blank: true, control_col: 'col-md-4'
  = f.select :rank, @unit.ranks, include_blank: true, control_col: 'col-md-2'


  = f.fields_for :unit_positions, @user.unit_positions.unit(@unit) || UnitPosition.new do |ff|
    = ff.hidden_field :unit_id, value: @unit.id
    = ff.select :leadership, @unit.scout_leadership_positions, include_blank: true, control_col: 'col-md-4'
    = ff.text_field :additional, class: 'form-control', placeholder: 'additional leadership positions', control_col: 'col-md-6', hide_label: true


  = f.date_select :birth, {start_year: 1930, end_year: Time.now.year, include_blank: true}, label: 'Birthday'

  %fieldset
    %legend Picture
    = f.form_group do
      .well.well-sm
        = image_tag @user.picture.url
    = f.file_field :picture, hide_label: true
    = f.form_group do
      = f.check_box :remove_picture, label: 'remove picture'
      .help-block alowed attachments: jpg jpeg gif png, at least 200px X 200px

  %fieldset
    %legend Phone numbers
    = f.form_group do
      = button_tag "add phone number", type: 'button', class: 'btn btn-success btn-sm add-phone-button'
    = f.fields_for :phones do |f_phone|
      = f_phone.form_group do
        .col-md-2
          = f_phone.select :kind, options_for_phones, hide_label: true, layout: :default
        .col-md-3.col-md-offset-1
          = f_phone.phone_field :number, hide_label: true, layout: :default
        .col-md-2.col-md-offset-1
          = f_phone.check_box :_destroy, label: 'remove'

    #add-a-phone

    #new-phone-fields.hidden
      = f.fields_for :phones, Phone.new, child_index: 'new_phone'  do |h_phone|
        = h_phone.form_group do
          .col-md-2
            = h_phone.select :kind, options_for_phones, hide_label: true, layout: :default
          .col-md-3.col-md-offset-1
            = h_phone.phone_field :number, hide_label: true, layout: :default
          .col-md-2.col-md-offset-1
            = h_phone.check_box :_destroy, label: 'remove'



  %fieldset
    %legend Address
    = f.text_field :address1, control_col: 'col-md-4'
    = f.text_field :address2, control_col: 'col-md-4'

    = f.text_field :city, control_col: 'col-md-3'
    = f.text_field :state, control_col: 'col-md-2'
    = f.text_field :zip_code, control_col: 'col-md-2'

  %fieldset
    %legend Parents (adults)
    = f.collection_select :adult_ids, @unit.adults.by_name_lf, :id, :name_lf, {label: 'Parents', help: 'parents will also be associated to the den(s)/patrol(s) of this Scout'}, {multiple: true, style: "width: 500px"}


  = f.form_group do
    = f.primary
    = link_to 'Cancel', unit_scouts_path(@unit), class: 'btn btn-default'
